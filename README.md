# .NET Database Wrapper
Extension for IDbConnection that simplifies database communication.

## Simple querying database
Model used in example:
```
public class Person
{
    public virtual long Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public virtual string FullName { get { return FirstName + " " + LastName; } }
    public int Age { get; set; }
    public Gender Gender { get; set; }
    public DateTime DateCreated { get; set; }
}

public enum Gender
{
    Unknown,
    Male,
    Female
}
```

Querying database and map to model:
```
Person[] persons;

using (IDbConnection c = DatabaseFactory.Create())
	persons = c.Query<Person>("SELECT * FROM persons").ToArray();
```

```persons``` now contains a list of ```Person``` with data pulled from the database.

Quite simple, right? Check out more examples below. Don't forget to read the "Important!" notes further down.

## Examples
Examples below will assume that property ```c``` is of type ```IDbConnection```

### Basic query
a list of the given type

```c.Query<Person>("SELECT * FROM persons");```

### Assoc query
a list of dictionary where key matches columns name

```c.QueryAssoc("SELECT id,first_name FROM persons");```

### Array query
a list of array where index matches columns index

```c.QueryArray("SELECT id,first_name FROM persons");```

### Insert
```
var data = new Person
{
    FirstName = "Dennis",
    LastName = "Ahlquist",
    Gender = Gender.Male,
    DateCreated = DateTime.Now
};
```

inserts ```data``` into table persons

```c.Insert("persons", data);```

**OR (with Postgres lib, more db-specific libs comming!)**

inserts ```data``` into table persons and returns auto-generated field id as int

```data.Id = c.Insert<int>("persons", data, "id");```

### Update
updates table persons and set ```data``` where id=1

```c.Update("persons", data, "id=@Id", new { Id = 1 });```

### Delete
deletes from table persons where first_name="Dennis"

```c.Delete("persons", "first_name=@FirstName", new { FirstName = "Dennis" });```

### Execute
execute anything, returning rows affected

```c.Execute("TRUNCATE persons");```

## Important!
```virtual``` properties is ignored on ```Insert``` and ```Update```, but will be mapped with ```Query```. Useful when there is an autogenerated id or you have a property in your model that doesn't match a column in the table.

```yield``` is used in ```Query```-methods. Make sure to read data before disposing the connection by calling ```.ToList()``` or ```.ToArray()```.

Uppercase in properties names will assume that the column name has an underscore before e.g. ```FirstName``` matches ```first_name``` column in database.

No more ```DBNull```! Seamless translates ```DBNull``` to ```null``` and ```null``` to ```DBNull```.